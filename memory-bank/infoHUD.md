# InfoHUD и Интерфейс Игры

Этот документ описывает устройство **InfoHUD** (Информационного Интерфейса) в проекте Skazmor — дополнительного слоя данных, который активируется по запросу игрока.

> **Важно:** InfoHUD не включает в себя основные элементы геймплея (поле битвы, слоты, аватар героя) или базовые системные кнопки ("Новая игра", "Правила"). Он относится исключительно к **дополнительной справочной информации**, которая появляется при активации режима "Info".

## Обзор
InfoHUD — это конфигурируемая система оверлеев. Она обеспечивает игрока углубленной информацией о состоянии колоды, истории событий и статистике, которую можно включать или отключать по желанию.

## Структура InfoHUD

Элементы InfoHUD становятся видимыми только когда активна кнопка **Info** (значок лупы) в нижней панели.

### 1. Верхняя панель (Top Panel Addons)
Дополнения к стандартной верхней панели.
*   **Детальная статистика (Deck Stats):** Ряд иконок рядом со счетчиком карт, показывающих точное количество карт каждого типа (Монстры, Монеты, Зелья, Щиты, Оружие, Свитки), оставшихся в колоде.

### 2. Нижняя панель управления (Control Overlays)
Элементы управления самим InfoHUD, появляющиеся рядом с кнопкой Info.
*   **Настройки (Settings):** Кнопка с шестеренкой. Открывает модальное окно, где игрок может выбрать, какие именно окна InfoHUD он хочет видеть (галочки вкл/выкл).
*   **Сброс окон (Reset Layout):** Кнопка возврата всех плавающих окон на исходные позиции.
*   **God Mode (Режим Бога):** Переключатель (глаз), активирующий бессмертие для целей тестирования/отладки.

### 3. Плавающие окна (Floating Windows)
Эти окна можно перемещать (Draggable) по экрану. Их видимость настраивается через меню "Настройки".

*   **Просмотр колоды (Deck Viewer):** Показывает прокручиваемый список карт, оставшихся в колоде.
*   **Просмотр сброса (Discard Viewer):** Показывает список уже сыгранных карт. Включает в себя панель статистики с разбивкой по типам (сколько монстров, монет и т.д. ушло в сброс), аналогичную статистике колоды.
*   **Журнал событий (Game Log):** Окно с историей последних действий (кто кого атаковал, сколько урона нанесено, эффекты лечения).
*   **Аналитика (Overhead Stats):** Панель с продвинутой статистикой эффективности:
    *   *Overheal:* Сколько лечения ушло впустую (когда HP полное).
    *   *Overkill:* Сколько урона нанесено сверх необходимого для убийства.
    *   *Overdef:* Сколько урона заблокировано броней впустую (когда урон меньше брони).
*   **Справочник меток (Monster Labels):** Легенда цветовой кодировки монстров (какой цвет рамки соответствует типу "Танк", "Босс" и т.д.).

## Настройки (Settings Modal)
Вызывается кнопкой-шестеренкой при активном режиме Info. Позволяет игроку кастомизировать свой HUD, скрывая ненужные элементы.
*   **Функция:** Управление видимостью каждого отдельного компонента (например, можно оставить только Журнал, скрыв Аналитику).
*   **Сохранение:** Настройки сохраняются между игровыми сессиями.

## Визуальный Стиль

Проект использует **Tailwind CSS** и **Framer Motion** для анимаций.

### Цветовая палитра
*   **Фон:** Очень темный (`bg-[#141211]`, `bg-stone-950`).
*   **Панели:** Полупрозрачный камень (`bg-stone-900/90`, `backdrop-blur-md`).
*   **Акценты (значения):**
    *   HP/Лечение: `emerald-400` / `emerald-500`.
    *   Урон/Враги: `rose-400` / `rose-500`.
    *   Магия/Свитки: `indigo-400`.
    *   Золото: `amber-400`.
    *   Щиты/Броня: `blue-400` / `stone-300`.
*   **Типографика:**
    *   Заголовки/Лейблы: Uppercase, tracking-widest, Bold.
    *   Цифры: Monospace (`font-mono`).

### Эффекты
*   **Стеклянный эффект:** Активное использование `backdrop-blur-sm/md` и полупрозрачных границ (`border-white/10`).
*   **Тени:** Глубокие тени (`shadow-2xl`) для создания объема плавающих окон.
*   **Анимации:**
    *   Плавное появление окон (`opacity`, `scale`).

## Техническая Реализация

### Состояние (State)
Весь UI берет данные из `GameScreen.tsx`.
*   **HUDSettingsModal:** Управляет видимостью компонентов через локальный стейт `hudVisibility`.
*   **God Mode:** Управляется через глобальный стейт игры (`isGodMode`).

### Персистентность (Storage)
Настройки интерфейса сохраняются в `localStorage` через утилиты в `src/utils/uiStorage.ts`:
*   `saveUIVisibility(visibility)`: Сохраняет выбор игрока (какие окна включены).
*   `saveUIPositions(positions)`: Сохраняет координаты X/Y перетаскиваемых окон.

## Как добавить новый элемент в InfoHUD

1.  Создать компонент в `src/components/`.
2.  Добавить ключ видимости в `src/types/game.ts` (чтобы его можно было отключать).
3.  Добавить переключатель в массив `SETTINGS` в `src/components/HUDSettingsModal.tsx` (иконка, название, описание).
4.  Внедрить компонент в `GameScreen.tsx`:
    *   Обернуть в проверку `showInfo` (глобальный переключатель).
    *   Обернуть в проверку `hudVisibility.вашКлюч` (пользовательская настройка).
    *   Использовать `AnimatePresence` для плавного скрытия.
5.  Если окно плавающее — использовать `motion.div` с атрибутом `drag` и обработчиком `onDragEnd` для сохранения позиции.
